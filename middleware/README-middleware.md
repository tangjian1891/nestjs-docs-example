# 中间件

什么是中间件?

- 中间件就是一个函数，在路由执行程序之前被调用。koa 的中间件是洋葱模型，比较特别。
  有什么功能?
- 执行特定的功能
- 提前结束请求-响应 .
- 调用堆栈中的下一个中间件函数.

# 在 nestjs 中如何使用?

- 照例来一个 User 模块吧
- class 编写中中间件
  中间件可以使用 class 的形式。需要 implements NestMiddleware 接口。
  然后直接注册到根模块上。根模块需要实现一个 implements NestModule 接口

* 函数中间件 (功能中间件)
  与 class 注册没有差别

另外注册确实可以注册到子模块上。可能这样的话，排查问题不太好。所以就统一注册在根模块吧

> 需求。实现一个验证 token 的中间件

直接一个一个注册到控制器。排除那些不需要的路由即可
